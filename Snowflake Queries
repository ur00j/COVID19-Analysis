SHOW TABLES;
DESCRIBE TABLE WHO_DAILY_REPORT;


SELECT *
FROM WHO_DAILY_REPORT;


SELECT COUNT(*) AS total_rows FROM WHO_DAILY_REPORT;

SELECT DISTINCT COUNTRY_REGION FROM WHO_DAILY_REPORT;

SELECT COUNT(*) AS missing_cases FROM WHO_DAILY_REPORT WHERE CASES IS NULL;

SELECT COUNTRY_REGION
FROM WHO_DAILY_REPORT
WHERE CASES_TOTAL IS NULL;

SELECT COUNTRY_REGION, 
       SUM(CASES_TOTAL) AS total_cases, 
       SUM(DEATHS_TOTAL) AS total_deaths, 
       AVG(CASES_TOTAL_PER_100000) AS avg_cases_per_100k, 
       MAX(CASES_TOTAL_PER_100000) AS max_cases_per_100k
    
FROM WHO_DAILY_REPORT
GROUP BY COUNTRY_REGION
ORDER BY total_cases DESC;

SELECT
    DATE,
    COUNTRY_REGION,
    SUM(CASES) AS total_cases,
    SUM(CASES_TOTAL) AS cumulative_cases,
    (SUM(CASES) / SUM(CASES_TOTAL)) * 100 AS daily_infection_rate
FROM
    WHO_DAILY_REPORT
GROUP BY
    DATE, COUNTRY_REGION
ORDER BY
    DATE, COUNTRY_REGION;


SELECT
    DATE,
    COUNTRY_REGION,
    SUM(DEATHS) AS total_deaths,
    SUM(DEATHS_TOTAL) AS cumulative_deaths,
    (SUM(DEATHS) / NULLIF(SUM(CASES), 0)) * 100 AS daily_mortality_rate
FROM
    WHO_DAILY_REPORT
GROUP BY
    DATE, COUNTRY_REGION
ORDER BY
    DATE, COUNTRY_REGION;

SELECT
    date,
    COUNTRY_REGION,
    CASES
FROM
    WHO_DAILY_REPORT
MATCH_RECOGNIZE (
    PARTITION BY COUNTRY_REGION
    ORDER BY DATE
    MEASURES
        STRT.DATE AS start_date,
        LAST(DATE) AS end_date,
        COUNT(CASES) AS days_count,
        SUM(CASES) AS total_cases
    PATTERN (STRT INCREASE*)
    DEFINE
        INCREASE AS CASES > (CASES)
) AS patterns;


